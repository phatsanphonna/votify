{"version":3,"file":"_server.ts-CxYOus1O.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/auth/signup/_server.ts.js"],"sourcesContent":["import { e as error, j as json } from \"../../../../../chunks/index2.js\";\nimport { object, string, ZodError } from \"zod\";\nimport { hash } from \"bcrypt\";\nimport { p as prisma } from \"../../../../../chunks/index4.js\";\nconst createUserSchema = object({\n  nationalId: string().length(13),\n  password: string().length(8),\n  confirmPassword: string()\n});\nconst POST = async ({ request }) => {\n  try {\n    const body = await createUserSchema.parseAsync(await request.json());\n    const user = await prisma.user.findUnique({\n      where: {\n        nationalId: body.nationalId\n      }\n    });\n    if (user) {\n      return error(400, JSON.stringify({ message: \"User already exists\" }));\n    }\n    const password = await hash(body.password, 5);\n    await prisma.user.create({\n      data: {\n        nationalId: body.nationalId,\n        password,\n        firstname: \"Test\",\n        lastname: \"User\"\n      }\n    });\n    return json({\n      message: \"User created successfully\"\n    });\n  } catch (err) {\n    if (err instanceof ZodError) {\n      return error(400, JSON.stringify(err.errors));\n    }\n    return error(500, JSON.stringify(err));\n  }\n};\nexport {\n  POST\n};\n"],"names":["object","string"],"mappings":";;;;;;AAIA,MAAM,gBAAgB,GAAGA,UAAM,CAAC;AAChC,EAAE,UAAU,EAAEC,UAAM,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC;AACjC,EAAE,QAAQ,EAAEA,UAAM,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;AAC9B,EAAE,eAAe,EAAEA,UAAM;AACzB,CAAC,CAAC;AACG,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,gBAAgB,CAAC,UAAU,CAAC,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACxE,IAAI,MAAM,IAAI,GAAG,MAAM,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;AAC9C,MAAM,KAAK,EAAE;AACb,QAAQ,UAAU,EAAE,IAAI,CAAC;AACzB;AACA,KAAK,CAAC;AACN,IAAI,IAAI,IAAI,EAAE;AACd,MAAM,OAAO,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;AAC3E;AACA,IAAI,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;AACjD,IAAI,MAAM,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;AAC7B,MAAM,IAAI,EAAE;AACZ,QAAQ,UAAU,EAAE,IAAI,CAAC,UAAU;AACnC,QAAQ,QAAQ;AAChB,QAAQ,SAAS,EAAE,MAAM;AACzB,QAAQ,QAAQ,EAAE;AAClB;AACA,KAAK,CAAC;AACN,IAAI,OAAO,IAAI,CAAC;AAChB,MAAM,OAAO,EAAE;AACf,KAAK,CAAC;AACN,GAAG,CAAC,OAAO,GAAG,EAAE;AAChB,IAAI,IAAI,GAAG,YAAY,QAAQ,EAAE;AACjC,MAAM,OAAO,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACnD;AACA,IAAI,OAAO,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC1C;AACA;;;;"}